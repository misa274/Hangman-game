import hashlib
import os
import json

# Save password to file
def save_password(service, password):
    hashed_password = hashlib.sha256(password.encode()).hexdigest()
    if os.path.exists("passwords.json"):
        with open("passwords.json", "r") as file:
            passwords = json.load(file)
    else:
        passwords = {}

    passwords[service] = hashed_password

    with open("passwords.json", "w") as file:
        json.dump(passwords, file)

# Load passwords from file
def load_passwords():
    if os.path.exists("passwords.json"):
        with open("passwords.json", "r") as file:
            return json.load(file)
    return {}

# Verify a password
def verify_password(service, password):
    passwords = load_passwords()
    hashed_password = hashlib.sha256(password.encode()).hexdigest()
    stored_password = passwords.get(service)

    if stored_password and stored_password == hashed_password:
        return True
    return False

# Main function to interact with the password manager
def password_manager():
    while True:
        print("Password Manager")
        print("1. Save a new password")
        print("2. Retrieve passwords")
        print("3. Verify a password")
        print("4. Quit")

        choice = input("Enter your choice: ")

        if choice == "1":
            service = input("Enter the service name: ")
            password = input("Enter the password: ")
            save_password(service, password)
            print("Password saved successfully!")
        elif choice == "2":
            passwords = load_passwords()
            if passwords:
                for service, hashed_password in passwords.items():
                    print(f"Service: {service}, Hashed Password: {hashed_password}")
            else:
                print("No passwords found.")
        elif choice == "3":
            service = input("Enter the service name: ")
            password = input("Enter the password: ")
            if verify_password(service, password):
                print("Password is correct!")
            else:
                print("Password is incorrect!")
        elif choice == "4":
            break
        else:
            print("Invalid choice, please try again.")

password_manager()
